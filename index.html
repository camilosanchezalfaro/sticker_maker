document.getElementById("remove-bg").addEventListener("click", function() {
    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
    const data = imageData.data;

    // Función para detectar un color promedio
    function getAverageColor(imageData) {
        let r = 0, g = 0, b = 0, count = 0;

        // Analizar los primeros y últimos píxeles de la imagen (esquinas)
        for (let i = 0; i < 1000; i += 4) {
            r += imageData[i];
            g += imageData[i + 1];
            b += imageData[i + 2];
            count++;
        }
        
        r = r / count;
        g = g / count;
        b = b / count;

        return { r, g, b };
    }

    // Obtener el color promedio de las esquinas
    const avgColor = getAverageColor(data);

    // Tolerancia para el color de fondo (puede ajustarse)
    const tolerance = 50;

    // Eliminar fondo basado en la diferencia de colores
    for (let i = 0; i < data.length; i += 4) {
        const r = data[i];
        const g = data[i + 1];
        const b = data[i + 2];

        // Si el píxel es similar al color de fondo, lo hacemos transparente
        if (Math.abs(r - avgColor.r) < tolerance &&
            Math.abs(g - avgColor.g) < tolerance &&
            Math.abs(b - avgColor.b) < tolerance) {
            data[i + 3] = 0; // Hacerlo transparente
        }
    }

    ctx.putImageData(imageData, 0, 0);
});
